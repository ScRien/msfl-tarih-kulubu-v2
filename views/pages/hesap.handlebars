<link rel="stylesheet" href="/css/hesap.css" />

<section class="account-wrapper">

  <!-- SOL MENÃœ -->
  <aside class="account-sidebar">

    <a href="/u/@{{user.username}}" class="public-profile-btn">
      Profilimi GÃ¶rÃ¼ntÃ¼le â†’
    </a>

    <div class="sidebar-category">Hesap</div>
    <button class="sidebar-item active" data-target="profile">Profil Bilgileri</button>

    <div class="sidebar-category">Hesap AyarlarÄ±</div>
    <button class="sidebar-item disabled">Tema AyarlarÄ± (YakÄ±nda)</button>
    <button class="sidebar-item disabled">Bildirimler (YakÄ±nda)</button>

    <div class="sidebar-category">Profil MedyasÄ±</div>
    <button class="sidebar-item" data-target="media">Profil FotoÄŸraflarÄ±</button>

    <div class="sidebar-category">Sosyal</div>
    <button class="sidebar-item" data-target="social">Sosyal Medya</button>

    <div class="sidebar-category">Gizlilik & GÃ¼venlik</div>
    <button class="sidebar-item" data-target="password">Åifre DeÄŸiÅŸtir</button>
    <button class="sidebar-item" data-target="cookies">Ã‡erez AyarlarÄ±</button>
    <button class="sidebar-item" data-target="data-usage">Veri KullanÄ±mÄ±</button>
    <button class="sidebar-item" data-target="devices" disabled>GiriÅŸ YapÄ±lan Cihazlar (YakÄ±nda)</button>
    <button class="sidebar-item danger" data-target="delete">HesabÄ± Sil</button>
    <button class="sidebar-item" data-target="policies">Site PolitikalarÄ±</button>

    <div class="sidebar-category">GeliÅŸmiÅŸ GÃ¼venlik</div>
    <button class="sidebar-item disabled">2FA DoÄŸrulama (YakÄ±nda)</button>
    <button class="sidebar-item disabled">Oturum YÃ¶netimi (YakÄ±nda)</button>

  </aside>

  <!-- SAÄ PANEL -->
  <main class="account-content">

    {{#if error}}
      <div class="account-alert error">âŒ {{error}}</div>
    {{/if}}

    {{#if success}}
      <div class="account-alert success">âœ… {{success}}</div>
    {{/if}}

    <!-- PROFÄ°L -->
    <div class="content-box" id="profile" style="display: block;">
      <h2 class="title">Profil Bilgileri</h2>
      <p class="desc">Bilgileriniz gÃ¼vende. DilediÄŸiniz zaman gÃ¼ncelleyebilirsiniz.</p>

      <form action="/hesap/profil" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />
        
        <div class="form-group">
          <label>KullanÄ±cÄ± AdÄ±</label>
          <input type="text" value="{{user.username}}" disabled />
          <span class="info">KullanÄ±cÄ± adÄ± deÄŸiÅŸtirilemez.</span>
        </div>

        <div class="form-group">
          <label>Ad</label>
          <input type="text" name="name" value="{{user.name}}" />
        </div>

        <div class="form-group">
          <label>Soyad</label>
          <input type="text" name="surname" value="{{user.surname}}" />
        </div>

        <div class="form-group">
          <label>E-posta</label>
          <input type="email" name="email" value="{{user.email}}" />
          <span class="info">E-posta doÄŸrulama ileride eklenecek.</span>
        </div>

        <div class="form-group">
          <label>Biyografi</label>
          <textarea 
            name="bio" 
            rows="4" 
            maxlength="200"
            placeholder="Kendinizi tanÄ±tan kÄ±sa bir yazÄ±..."
          >{{user.bio}}</textarea>

          <div class="bio-hint">
            <span>200 karakter sÄ±nÄ±rÄ±</span>
          </div>
        </div>

        <div class="btn-group">
          <button type="submit" class="btn save">Kaydet</button>
          <button type="reset" class="btn cancel">Ä°ptal</button>
        </div>
      </form>
    </div>

    <!-- SOSYAL -->
    <div class="content-box" id="social">
      <h2 class="title">Sosyal Medya BaÄŸlantÄ±larÄ±</h2>
      <p class="desc">Profilinde gÃ¶rÃ¼necek sosyal medya baÄŸlantÄ±larÄ±.</p>

      <form action="/hesap/social" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />

        <div class="form-group">
          <label>Instagram</label>
          <input type="text" name="instagram" value="{{user.social.instagram}}" />
        </div>

        <div class="form-group">
          <label>X (Twitter)</label>
          <input type="text" name="x" value="{{user.social.x}}" />
        </div>

        <div class="form-group">
          <label>GitHub</label>
          <input type="text" name="github" value="{{user.social.github}}" />
        </div>

        <div class="btn-group">
          <button type="submit" class="btn save">Kaydet</button>
          <button type="reset" class="btn cancel">Ä°ptal</button>
        </div>

      </form>
    </div>

    <!-- PROFÄ°L MEDYASI -->
    <div class="content-box" id="media">
      <h2 class="title">Profil FotoÄŸraflarÄ±</h2>
      <p class="desc">Profil ve kapak fotoÄŸrafÄ±nÄ±zÄ± buradan yÃ¶netebilirsiniz.</p>

      <div class="profile-section">
        <h3>Profil FotoÄŸrafÄ±</h3>

        <div class="avatar-box">
          <img src="{{user.avatar}}" id="avatarPreview" class="avatar-img" />
        </div>

        <form id="avatarForm" action="/hesap/avatar-yukle" method="POST">
          <input type="hidden" name="_csrf" value="{{csrfToken}}" />
          <input type="hidden" name="avatarUrl" id="avatarUrl" />

          <label for="avatarUpload" class="upload-btn">Yeni Avatar YÃ¼kle</label>
          <input type="file" id="avatarUpload" class="hidden-input" accept="image/*" />

          <button type="submit" class="save-btn">Kaydet</button>
        </form>
      </div>

      <div class="cover-section">
        <h3>Kapak FotoÄŸrafÄ±</h3>

        <div class="cover-box">
          <img src="{{user.coverPhoto}}" id="coverPreview" class="cover-img" />
        </div>

        <form id="coverForm" action="/hesap/kapak-yukle" method="POST">
          <input type="hidden" name="_csrf" value="{{csrfToken}}" />
          <input type="hidden" name="coverUrl" id="coverUrl" />

          <label for="coverUpload" class="upload-btn">Yeni Kapak YÃ¼kle</label>
          <input type="file" id="coverUpload" class="hidden-input" accept="image/*" />

          <button type="submit" class="save-btn">Kaydet</button>
        </form>
      </div>
    </div>

    <!-- ÅÄ°FRE -->
    <div class="content-box" id="password">
      <h2 class="title">Åifre DeÄŸiÅŸtir</h2>
      <p class="desc">Mail adresine doÄŸrulama kodu gÃ¶nderilecek.</p>

      <form action="/hesap/sifre-kod" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />
        <button class="btn save">Mailime Kod GÃ¶nder</button>
      </form>

      <div id="verifyBox" style="display:none;margin-top:20px;">
        <h3 class="subtitle">DoÄŸrulama Kodu</h3>

        <form action="/hesap/sifre-kod-dogrula-form" method="POST">
          <input type="hidden" name="_csrf" value="{{csrfToken}}" />
          <input type="text" name="code" class="input" required />

          <button class="btn green">Kodu DoÄŸrula</button>
        </form>
      </div>

      <div id="newPasswordBox" style="display:none;margin-top:30px;">
        <h3 class="subtitle">Yeni Åifre OluÅŸtur</h3>

        <form action="/hesap/sifre-yeni" method="POST">
          <input type="hidden" name="_csrf" value="{{csrfToken}}" />
          <input type="password" name="password1" class="input" required />
          <input type="password" name="password2" class="input" required />

          <button class="btn save">Åifreyi GÃ¼ncelle</button>
        </form>
      </div>

    </div>

    <!-- Ã‡EREZLER -->
    <div class="content-box" id="cookies">
      <h2 class="title">Ã‡erez AyarlarÄ±</h2>

      <form action="/hesap/cookies" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />

        <div class="toggle-row">
          <label>Gerekli Ã‡erezler</label>
          <input type="checkbox" checked disabled />
        </div>

        <div class="toggle-row">
          <label>Analitik Ã‡erezler</label>
          <label class="switch">
            <input type="checkbox" name="analyticsCookies" {{#if user.analyticsCookies}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <div class="toggle-row">
          <label>KiÅŸiselleÅŸtirme Ã‡erezleri</label>
          <label class="switch">
            <input type="checkbox" name="personalizationCookies" {{#if user.personalizationCookies}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <div class="btn-group">
          <button class="btn save">Kaydet</button>
          <button class="btn cancel" type="reset">Ä°ptal</button>
        </div>
      </form>
    </div>

    <!-- VERÄ° -->
    <div class="content-box" id="data-usage">
      <h2 class="title">Veri KullanÄ±mÄ±</h2>

      <form action="/hesap/data-usage" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />

        <div class="toggle-row">
          <label>Hizmet kalitesi iÃ§in anonim veri</label>
          <label class="switch">
            <input type="checkbox" name="serviceDataUsage" {{#if user.serviceDataUsage}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <div class="toggle-row">
          <label>KiÅŸiselleÅŸtirilmiÅŸ iÃ§erik</label>
          <label class="switch">
            <input type="checkbox" name="personalizedContent" {{#if user.personalizedContent}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <div class="btn-group">
          <button class="btn save">Kaydet</button>
          <button class="btn cancel" type="reset">Ä°ptal</button>
        </div>
      </form>
    </div>

    <!-- HESAP SÄ°LME -->
    <div class="content-box" id="delete">
      <h2 class="title danger">HesabÄ± Sil</h2>
      <p class="desc">HesabÄ±nÄ±zÄ± kalÄ±cÄ± olarak silmek iÃ§in aÅŸaÄŸÄ±daki butona tÄ±klayÄ±n.</p>

      <button class="danger-btn" onclick="openDeleteModal()">
        HesabÄ±mÄ± KalÄ±cÄ± Olarak Sil
      </button>
    </div>

    <!-- POLÄ°TÄ°KALAR -->
    <div class="content-box" id="policies">
      <h2 class="title">Site PolitikalarÄ±</h2>

      <div class="policy-card">
        <h3 class="policy-title">ğŸ“˜ KVKK</h3>
        <a href="/legal/kvkk" class="policy-link">KVKK Metni â†’</a>
      </div>

      <div class="policy-card">
        <h3 class="policy-title">ğŸ”’ Gizlilik</h3>
        <a href="/legal/gizlilik" class="policy-link">Gizlilik PolitikasÄ± â†’</a>
      </div>

      <div class="policy-card">
        <h3 class="policy-title">ğŸ“„ KullanÄ±m ÅartlarÄ±</h3>
        <a href="/legal/kullanim-sartlari" class="policy-link">KullanÄ±m ÅartlarÄ± â†’</a>
      </div>

    </div>

    <!-- HESAP SÄ°LME MODAL -->
    <div id="deleteModal" class="delete-modal">
      <div class="delete-modal-content">

        <h2>HesabÄ± Sil</h2>
        <p class="warning-text">Bu iÅŸlem geri alÄ±namaz. Emin misiniz?</p>

        <input type="hidden" id="csrfDelete" value="{{csrfToken}}" />

        <label class="modal-label">Onay iÃ§in C harfini girin:</label>
        <input type="text" id="confirmC" maxlength="1" class="modal-input" />

        <label class="modal-label">Åifrenizi girin:</label>
        <input type="password" id="deletePassword" class="modal-input" />

        <p id="modalError" class="modal-error"></p>

        <div class="modal-buttons">
          <button class="cancel-btn" onclick="closeDeleteModal()">VazgeÃ§</button>
          <button class="delete-btn" onclick="confirmDelete()">HesabÄ± Sil</button>
        </div>

      </div>
    </div>

  </main>
</section>

<script src="/js/avatarCoverUpload.js"></script>
<script src="/js/hesap.js"></script>
