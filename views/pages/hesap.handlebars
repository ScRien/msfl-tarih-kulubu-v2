<link rel="stylesheet" href="/css/hesap.css" />

<section class="account-wrapper">

  <!-- SOL MENÃœ -->
  <aside class="account-sidebar">

    <a href="/@{{user.username}}" class="public-profile-btn">
      Profilimi GÃ¶rÃ¼ntÃ¼le â†’
    </a>

    <div class="sidebar-category">Hesap</div>
    <button class="sidebar-item active" data-target="profile">Profil Bilgileri</button>

    <div class="sidebar-category">Hesap AyarlarÄ±</div>
    <button class="sidebar-item disabled">Tema AyarlarÄ± (YakÄ±nda)</button>
    <button class="sidebar-item disabled">Bildirimler (YakÄ±nda)</button>

    <div class="sidebar-category">Profil MedyasÄ±</div>
    <button class="sidebar-item" data-target="media">Profil FotoÄŸraflarÄ±</button>

    <div class="sidebar-category">Sosyal</div>
    <button class="sidebar-item" data-target="social">Sosyal Medya</button>

    <div class="sidebar-category">Gizlilik & GÃ¼venlik</div>
    <button class="sidebar-item" data-target="password">Åifre DeÄŸiÅŸtir</button>
    <button class="sidebar-item" data-target="cookies">Ã‡erez AyarlarÄ±</button>
    <button class="sidebar-item" data-target="data-usage">Veri KullanÄ±mÄ±</button>
    <button class="sidebar-item" data-target="devices" disabled>GiriÅŸ YapÄ±lan Cihazlar (YakÄ±nda)</button>
    <button class="sidebar-item danger" data-target="delete">HesabÄ± Sil</button>
    <button class="sidebar-item" data-target="policies">Site PolitikalarÄ±</button>

    <div class="sidebar-category">GeliÅŸmiÅŸ GÃ¼venlik</div>
    <button class="sidebar-item disabled">2FA DoÄŸrulama (YakÄ±nda)</button>
    <button class="sidebar-item disabled">Oturum YÃ¶netimi (YakÄ±nda)</button>

  </aside>

  <!-- SAÄ PANEL -->
  <main class="account-content">

    {{#if error}}
      <div class="account-alert error">âŒ {{error}}</div>
    {{/if}}

    {{#if success}}
      <div class="account-alert success">âœ… {{success}}</div>
    {{/if}}

    <!-- PROFÄ°L -->
    <div class="content-box" id="profile" style="display: block;">
      <h2 class="title">Profil Bilgileri</h2>
      <p class="desc">Bilgileriniz gÃ¼vende. DilediÄŸiniz zaman gÃ¼ncelleyebilirsiniz.</p>

      <form action="/hesap/profil" method="POST">
        
        <div class="form-group">
          <label>KullanÄ±cÄ± AdÄ±</label>
          <input type="text" value="{{user.username}}" disabled />
          <span class="info">KullanÄ±cÄ± adÄ± deÄŸiÅŸtirilemez.</span>
        </div>

        <div class="form-group">
          <label>Ad</label>
          <input type="text" name="name" value="{{user.name}}" />
        </div>

        <div class="form-group">
          <label>Soyad</label>
          <input type="text" name="surname" value="{{user.surname}}" />
        </div>

        <div class="form-group">
          <label>E-posta</label>
          <input type="email" name="email" value="{{user.email}}" />
          <span class="info">E-posta doÄŸrulama ileride eklenecek.</span>
        </div>

        <!-- BÄ°YOGRAFÄ° -->
        <div class="form-group">
          <label>Biyografi</label>
          <textarea 
            name="bio" 
            rows="4" 
            maxlength="200"
            placeholder="Kendinizi tanÄ±tan kÄ±sa bir yazÄ±..."
          >{{user.bio}}</textarea>

          <div class="bio-hint">
            <span>200 karakter sÄ±nÄ±rÄ±</span>
          </div>
        </div>

        <div class="btn-group">
          <button type="submit" class="btn save">Kaydet</button>
          <button type="reset" class="btn cancel">Ä°ptal</button>
        </div>
      </form>
    </div>

    <!-- SOSYAL -->
    <div class="content-box" id="social">
      <h2 class="title">Sosyal Medya BaÄŸlantÄ±larÄ±</h2>
      <p class="desc">Profilinde gÃ¶rÃ¼necek sosyal medya baÄŸlantÄ±larÄ±.</p>

      <form action="/hesap/social" method="POST">

        <div class="form-group">
          <label>Instagram</label>
          <input type="text" name="instagram" value="{{user.social.instagram}}" placeholder="@kullanici" />
        </div>

        <div class="form-group">
          <label>X (Twitter)</label>
          <input type="text" name="x" value="{{user.social.x}}" placeholder="@kullanici" />
        </div>

        <div class="form-group">
          <label>GitHub</label>
          <input type="text" name="github" value="{{user.social.github}}" placeholder="github.com/kullanici" />
        </div>

        <div class="btn-group">
          <button type="submit" class="btn save">Kaydet</button>
          <button type="reset" class="btn cancel">Ä°ptal</button>
        </div>

      </form>
    </div>

    <!-- PROFÄ°L MEDYASI -->
    <div class="content-box" id="media">
      <h2 class="title">Profil FotoÄŸraflarÄ±</h2>
      <p class="desc">Profil ve kapak fotoÄŸrafÄ±nÄ±zÄ± buradan yÃ¶netebilirsiniz.</p>

      <!-- AVATAR -->
      <div class="media-section">
        <h3 class="media-title">Profil FotoÄŸrafÄ±</h3>

        <img 
          class="media-avatar-preview"
          src="{{user.avatar}}"
          alt="Avatar"
        />

        <p class="info">Ã–nerilen boyut: 300Ã—300 px (kare)</p>

        <form action="/hesap/avatar-yukle" method="POST" enctype="multipart/form-data">
          <input type="file" name="avatar" accept="image/*" class="media-input" required />
          <button class="btn save">Profil FotoÄŸrafÄ±nÄ± GÃ¼ncelle</button>
        </form>
      </div>

      <!-- KAPAK -->
      <div class="media-section" style="margin-top:32px;">
        <h3 class="media-title">Kapak FotoÄŸrafÄ±</h3>

        <img 
          class="media-cover-preview"
          src="{{user.coverPhoto}}"
          alt="Kapak"
        />

        <p class="info">Ã–nerilen boyut: 1200Ã—280 px</p>

        <form action="/hesap/kapak-yukle" method="POST" enctype="multipart/form-data">
          <input type="file" name="cover" accept="image/*" class="media-input" required />
          <button class="btn save">Kapak FotoÄŸrafÄ±nÄ± GÃ¼ncelle</button>
        </form>
      </div>
    </div>

    <!-- ÅÄ°FRE -->
    <div class="content-box" id="password">
      <h2 class="title">Åifre DeÄŸiÅŸtir</h2>
      <p class="desc">Mail adresine doÄŸrulama kodu gÃ¶nderilecek.</p>

      <!-- 1) Kod gÃ¶nder -->
      <form action="/hesap/sifre-kod" method="POST">
        <button class="btn save">
          <i class="fa-solid fa-paper-plane"></i> Mailime Kod GÃ¶nder
        </button>
      </form>

      <!-- 2) DoÄŸrulama kutusu -->
      <div id="verifyBox" style="display: none; margin-top:20px;">
        <h3 class="subtitle">DoÄŸrulama Kodu</h3>

        <form action="/hesap/sifre-kod-dogrula-form" method="POST">
          <input type="text" name="code" placeholder="6 haneli kod" class="input" required />
          <button class="btn green">
            <i class="fa-solid fa-lock"></i> Kodu DoÄŸrula
          </button>
        </form>
      </div>

      <!-- 3) Yeni ÅŸifre -->
      <div id="newPasswordBox" style="display: none; margin-top: 30px;">
        <h3 class="subtitle">Yeni Åifre OluÅŸtur</h3>

        <form action="/hesap/sifre-yeni" method="POST">
          <input type="password" name="password1" placeholder="Yeni Åifre" class="input" required />
          <input type="password" name="password2" placeholder="Yeni Åifre Tekrar" class="input" required />

          <button class="btn save">
            <i class="fa-solid fa-unlock-keyhole"></i> Åifreyi GÃ¼ncelle
          </button>
        </form>
      </div>

    </div>

    <!-- Ã‡EREZLER -->
    <div class="content-box" id="cookies">
      <h2 class="title">Ã‡erez AyarlarÄ±</h2>
      <p class="desc">TarayÄ±cÄ± Ã§erezleri deneyimi iyileÅŸtirir.</p>

      <form action="/hesap/cookies" method="POST">
        <div class="toggle-row">
          <label>Gerekli Ã‡erezler</label>
          <input type="checkbox" checked disabled />
        </div>

        <div class="toggle-row">
          <label>Analitik Ã‡erezler</label>
          <label class="switch">
            <input type="checkbox" name="analyticsCookies"
              {{#if user.analyticsCookies}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <div class="toggle-row">
          <label>KiÅŸiselleÅŸtirme Ã‡erezleri</label>
          <label class="switch">
            <input type="checkbox" name="personalizationCookies"
              {{#if user.personalizationCookies}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <div class="btn-group">
          <button class="btn save">Kaydet</button>
          <button class="btn cancel" type="reset">Ä°ptal</button>
        </div>
      </form>
    </div>

    <!-- VERÄ° -->
    <div class="content-box" id="data-usage">
      <h2 class="title">Veri KullanÄ±mÄ±</h2>

      <form action="/hesap/data-usage" method="POST">
        <div class="toggle-row">
          <label>Hizmet kalitesi iÃ§in anonim veri</label>
          <label class="switch">
            <input type="checkbox" name="serviceDataUsage"
              {{#if user.serviceDataUsage}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <div class="toggle-row">
          <label>KiÅŸiselleÅŸtirilmiÅŸ iÃ§erik</label>
          <label class="switch">
            <input type="checkbox" name="personalizedContent"
              {{#if user.personalizedContent}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <div class="btn-group">
          <button class="btn save">Kaydet</button>
          <button class="btn cancel" type="reset">Ä°ptal</button>
        </div>
      </form>
    </div>

    <!-- HESAP SÄ°L -->
    <div class="content-box" id="delete">
      <h2 class="title danger">HesabÄ± Sil</h2>
      <p class="warn">
        Bu iÅŸlem geri alÄ±namaz. HesabÄ±nÄ± silmeden Ã¶nce tÃ¼m verilerini indirmeni Ã¶neririz.
      </p>

      <form action="/hesap/sil" method="POST"
        onsubmit="return confirm('HesabÄ±nÄ±zÄ± ve tÃ¼m iÃ§eriklerinizi kalÄ±cÄ± olarak silmek istiyor musunuz?')">
        <button class="danger-btn">HesabÄ± KalÄ±cÄ± Olarak Sil</button>
      </form>
    </div>

    <!-- POLÄ°TÄ°KALAR -->
    <div class="content-box" id="policies">
      <h2 class="title">Site PolitikalarÄ±</h2>
      <p class="desc">Gizlilik, veri politikasÄ± ve kullanÄ±m ÅŸartlarÄ±.</p>

      <div class="policy-card">
        <h3 class="policy-title">ğŸ“˜ KVKK</h3>
        <a href="/kvkk" class="policy-link">KVKK Metni â†’</a>
      </div>

      <div class="policy-card">
        <h3 class="policy-title">ğŸ”’ Gizlilik</h3>
        <a href="/gizlilik" class="policy-link">Gizlilik PolitikasÄ± â†’</a>
      </div>

      <div class="policy-card">
        <h3 class="policy-title">ğŸ“„ KullanÄ±m ÅartlarÄ±</h3>
        <a href="/kullanim-sartlari" class="policy-link">KullanÄ±m ÅartlarÄ± â†’</a>
      </div>

    </div>

  </main>
</section>

<script src="/js/hesap.js"></script>

{{!-- ğŸ”¥ URL PARAMETRESÄ°NE GÃ–RE DOÄRULAMA ALANINI OTOMATÄ°K AÃ‡ --}}
<script>
  const urlParams = new URLSearchParams(window.location.search);

  if (urlParams.get("showVerify") == "1") {
    document.getElementById("verifyBox").style.display = "block";
  }

  if (window.location.pathname.includes("sifre-yeni")) {
    document.getElementById("newPasswordBox").style.display = "block";
  }
</script>
