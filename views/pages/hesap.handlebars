<section class="account-page">
  <div class="account-container">

    <!-- ===== ÜST MESAJLAR ===== -->
    {{#if success}}
      <div class="account-alert success">
        <i class="fa-solid fa-circle-check"></i>
        {{success}}
      </div>
    {{/if}}

    {{#if error}}
      <div class="account-alert error">
        <i class="fa-solid fa-triangle-exclamation"></i>
        {{error}}
      </div>
    {{/if}}

    <!-- ===== LAYOUT ===== -->
    <div class="account-layout">

      <!-- ===== SOL MENÜ ===== -->
      <aside class="account-sidebar">
        <button class="sidebar-item active" data-target="profile">
          Profil Bilgileri
        </button>
        <button class="sidebar-item" data-target="privacy">
          Çerez ve Gizlilik
        </button>
        <button class="sidebar-item" data-target="data">
          Veri Kullanımı
        </button>
        <button class="sidebar-item" data-target="media">
          Avatar & Kapak
        </button>
        <button class="sidebar-item" data-target="password">
          Şifre Güvenliği
        </button>
        <button class="sidebar-item danger-btn" data-target="danger">
          Hesabı Sil
        </button>
      </aside>

      <!-- ===== SAĞ TARAF İÇERİKLER ===== -->
      <div class="account-content">

        <!-- ========== PROFİL BİLGİLERİ ========== -->
        <div class="content-box" id="profile" style="display: block;">
          <h2 class="content-title">Profil Bilgileri</h2>

          <form action="/hesap/profil" method="POST" class="form-block">
            <div class="form-row">
              <div class="form-group">
                <label>Ad</label>
                <input
                  type="text"
                  name="name"
                  value="{{user.name}}"
                  required
                />
              </div>

              <div class="form-group">
                <label>Soyad</label>
                <input
                  type="text"
                  name="surname"
                  value="{{user.surname}}"
                  required
                />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Kullanıcı Adı</label>
                <input
                  type="text"
                  value="{{user.username}}"
                  disabled
                />
                <small> Kullanıcı adını değiştirmek için yönetici ile iletişime geç. </small>
              </div>

              <div class="form-group">
                <label>E-posta</label>
                <input
                  type="email"
                  name="email"
                  value="{{user.email}}"
                  required
                />
              </div>
            </div>

            <div class="form-group">
              <label>Hakkımda (Bio)</label>
              <textarea
                name="bio"
                rows="3"
                placeholder="Kendini kısaca tanıt..."
              >{{user.bio}}</textarea>
            </div>

            <button type="submit" class="primary-btn">
              Kaydet
            </button>
          </form>
        </div>

        <!-- ========== ÇEREZ VE GİZLİLİK ========== -->
        <div class="content-box" id="privacy" style="display: none;">
          <h2 class="content-title">Çerez ve Gizlilik Tercihleri</h2>

          <form action="/hesap/cookies" method="POST" class="form-block">
            <div class="checkbox-row">
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  name="analyticsCookies"
                  {{#if user.analyticsCookies}}checked{{/if}}
                />
                <span>Analitik çerezlere izin veriyorum.</span>
              </label>
            </div>

            <div class="checkbox-row">
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  name="personalizationCookies"
                  {{#if user.personalizationCookies}}checked{{/if}}
                />
                <span>İçeriklerin kişiselleştirilmesine izin veriyorum.</span>
              </label>
            </div>

            <button type="submit" class="primary-btn">
              Çerez Ayarlarını Kaydet
            </button>
          </form>
        </div>

        <!-- ========== VERİ KULLANIMI ========== -->
        <div class="content-box" id="data" style="display: none;">
          <h2 class="content-title">Veri Kullanımı ve Tercihler</h2>

          <form action="/hesap/data-usage" method="POST" class="form-block">
            <div class="checkbox-row">
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  name="serviceDataUsage"
                  {{#if user.serviceDataUsage}}checked{{/if}}
                />
                <span>
                  Hizmet kalitesini artırmak için verilerimin anonim olarak
                  kullanılmasına izin veriyorum.
                </span>
              </label>
            </div>

            <div class="checkbox-row">
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  name="personalizedContent"
                  {{#if user.personalizedContent}}checked{{/if}}
                />
                <span>
                  Bana gösterilen içeriklerin ilgi alanlarıma göre
                  özelleştirilmesini kabul ediyorum.
                </span>
              </label>
            </div>

            <button type="submit" class="primary-btn">
              Veri Ayarlarını Kaydet
            </button>
          </form>
        </div>

        <!-- ========== AVATAR & KAPAK ========== -->
        <div class="content-box" id="media" style="display: none;">
          <h2 class="content-title">Avatar ve Kapak Fotoğrafı</h2>

          <div class="media-grid">
            <!-- Avatar -->
            <div class="media-card">
              <h3>Profil Fotoğrafı</h3>

              <div class="avatar-box">
                <img
                  id="avatarPreview"
                  class="avatar-img"
                  src="{{#if user.avatar}}{{user.avatar}}{{else}}/img/profile-placeholder.jpg{{/if}}"
                  alt="Profil Fotoğrafı"
                />
              </div>

              <form id="avatarForm" action="/hesap/avatar-yukle" method="POST">
                <input type="hidden" name="avatarUrl" id="avatarUrl" />

                <label for="avatarUpload" class="upload-btn">
                  Dosya Seç
                </label>
                <input
                  type="file"
                  id="avatarUpload"
                  class="hidden-input"
                  accept="image/*"
                />

                <button type="submit" class="primary-btn small-btn">
                  Kaydet
                </button>
              </form>
            </div>

            <!-- Kapak -->
            <div class="media-card">
              <h3>Kapak Fotoğrafı</h3>

              <div class="cover-box">
                <img
                  id="coverPreview"
                  class="cover-img"
                  src="{{#if user.coverPhoto}}{{user.coverPhoto}}{{else}}/img/cover-placeholder.jpg{{/if}}"
                  alt="Kapak Fotoğrafı"
                />
              </div>

              <form id="coverForm" action="/hesap/kapak-yukle" method="POST">
                <input type="hidden" name="coverUrl" id="coverUrl" />

                <label for="coverUpload" class="upload-btn">
                  Dosya Seç
                </label>
                <input
                  type="file"
                  id="coverUpload"
                  class="hidden-input"
                  accept="image/*"
                />

                <button type="submit" class="primary-btn small-btn">
                  Kaydet
                </button>
              </form>
            </div>
          </div>

          <!-- Sosyal Medya -->
          <div class="social-section">
            <h3>Sosyal Medya Bağlantıları</h3>

            <form action="/hesap/social" method="POST" class="form-block">
              <div class="form-row">
                <div class="form-group">
                  <label>Instagram</label>
                  <input
                    type="text"
                    name="instagram"
                    value="{{user.social.instagram}}"
                    placeholder="@kullanici"
                  />
                </div>
                <div class="form-group">
                  <label>X (Twitter)</label>
                  <input
                    type="text"
                    name="x"
                    value="{{user.social.x}}"
                    placeholder="@kullanici"
                  />
                </div>
                <div class="form-group">
                  <label>GitHub</label>
                  <input
                    type="text"
                    name="github"
                    value="{{user.social.github}}"
                    placeholder="kullanici-adi"
                  />
                </div>
              </div>

              <button type="submit" class="primary-btn">
                Sosyal Medyayı Güncelle
              </button>
            </form>
          </div>
        </div>

        <!-- ========== ŞİFRE GÜVENLİĞİ ========== -->
        <div class="content-box" id="password" style="display: none;">
          <h2 class="content-title">Şifre Güvenliği</h2>

          <!-- 1. Adım: KOD GÖNDER -->
          <div class="password-block">
            <h3>1. Adım — Doğrulama Kodu Gönder</h3>
            <p>
              E-posta adresine bir doğrulama kodu gönderilecektir. Bu kodu
              kullanarak yeni şifre belirleyebilirsin.
            </p>

            <form
              action="/hesap/sifre-kod"
              method="POST"
              class="form-inline"
            >
              <button type="submit" class="primary-btn">
                Kodu Gönder
              </button>
            </form>
          </div>

          <!-- 2. Adım: KODU GİR -->
          <div
            class="password-block"
            id="verifyBox"
            style="display: {{#if showVerify}}block{{else}}none{{/if}};"
          >
            <h3>2. Adım — Kodu Doğrula</h3>
            <p>
              E-postana gelen 6 haneli kodu gir.
            </p>

            <form
              action="/hesap/sifre-kod-dogrula-form"
              method="POST"
              class="form-inline"
            >
              <input
                type="text"
                name="code"
                placeholder="Doğrulama Kodu"
                required
              />
              <button type="submit" class="primary-btn">
                Kodu Doğrula
              </button>
            </form>
          </div>

          <!-- 3. Adım: YENİ ŞİFRE -->
          <div
            class="password-block"
            id="newPasswordBox"
            style="display: none;"
          >
            <h3>3. Adım — Yeni Şifre Belirle</h3>

            <form
              action="/hesap/sifre-yeni"
              method="POST"
              class="form-block"
            >
              <div class="form-row">
                <div class="form-group">
                  <label>Yeni Şifre</label>
                  <input
                    type="password"
                    name="password1"
                    required
                  />
                </div>

                <div class="form-group">
                  <label>Yeni Şifre (Tekrar)</label>
                  <input
                    type="password"
                    name="password2"
                    required
                  />
                </div>
              </div>

              <button type="submit" class="primary-btn">
                Şifreyi Güncelle
              </button>
            </form>
          </div>
        </div>

        <!-- ========== HESABI SİL ========== -->
        <div class="content-box" id="danger" style="display: none;">
          <h2 class="content-title danger-title">Hesabı Sil</h2>

          <div class="danger-box">
            <p>
              Bu işlem <strong>geri alınamaz</strong>. Hesabınla birlikte
              oluşturduğun blog yazıları ve yorumların da kalıcı olarak
              silinecektir.
            </p>

            <form
              action="/hesap/sil"
              method="POST"
              onsubmit="return confirm('Hesabını kalıcı olarak silmek istediğine emin misin?');"
            >
              <button type="submit" class="danger-btn-full">
                Hesabımı Kalıcı Olarak Sil
              </button>
            </form>
          </div>
        </div>

      </div>
    </div>
  </div>
</section>

<!-- ===== SCRIPT ===== -->
<script src="/js/account.js"></script>
<script src="/js/avatarCoverUpload.js"></script>
  