<link rel="stylesheet" href="/css/hesap.css?v=4" />

<section class="account-wrapper">

  <!-- ========== SOL SIDEBAR ========== -->
  <aside class="account-sidebar">

    <a href="/u/@{{username}}" class="public-profile-btn">
      Profilimi GÃ¶rÃ¼ntÃ¼le â†’
    </a>

    <div class="sidebar-category">Hesap</div>
    <button type="button" class="sidebar-item active" data-target="profile">
      Profil Bilgileri
    </button>

    <div class="sidebar-category">Profil MedyasÄ±</div>
    <button type="button" class="sidebar-item" data-target="media">
      Profil FotoÄŸraflarÄ±
    </button>

    <div class="sidebar-category">Sosyal</div>
    <button type="button" class="sidebar-item" data-target="social">
      Sosyal Medya
    </button>

    <div class="sidebar-category">Veri & Gizlilik</div>
    <button type="button" class="sidebar-item" data-target="data-usage">
      Veri KullanÄ±mÄ± & Ã‡erez Ä°zinleri
    </button>
    <button type="button" class="sidebar-item" data-target="policies">
      Gizlilik & Politikalar
    </button>

    <div class="sidebar-category">Gizlilik & GÃ¼venlik</div>
    <button type="button" class="sidebar-item" data-target="password">
      Åifre DeÄŸiÅŸtir
    </button>

    <div class="sidebar-category">DiÄŸer</div>
    <button type="button" class="sidebar-item danger" data-target="delete">
      HesabÄ± Sil
    </button>

  </aside>


  <!-- ========== SAÄ PANEL ========== -->
  <main class="account-content">

    <!-- LOADER -->
    <div id="accountLoading" class="account-loading">
      <div class="spinner"></div>
      <p>Hesap bilgileri yÃ¼kleniyor...</p>
    </div>


    <!-- ========== PROFÄ°L ========== -->
    <div class="content-box" id="profile" style="display:block;">
      <h2 class="title">Profil Bilgileri</h2>
      <p class="desc">Bilgilerinizi buradan gÃ¼ncelleyebilirsiniz.</p>

      <form id="profileForm" action="/hesap/profil" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />

        <div class="form-group">
          <label>KullanÄ±cÄ± AdÄ±</label>
          <input
            name="username"
            value="{{user.username}}"
            minlength="3"
            maxlength="20"
            pattern="^[a-zA-Z0-9._]+$"
            required
          />
          <span class="info">
            Harf, rakam, nokta (.) ve alt Ã§izgi (_) kullanÄ±labilir.
          </span>
        </div>

        <div class="form-group">
          <label>Ad</label>
          <input name="name" value="{{user.name}}" disabled />
          <span class="info">Bu alan deÄŸiÅŸtirilemez.</span>
        </div>

        <div class="form-group">
          <label>Soyad</label>
          <input name="surname" value="{{user.surname}}" disabled />
          <span class="info">Bu alan deÄŸiÅŸtirilemez.</span>
        </div>

        <div class="form-group">
          <label>E-posta</label>
          <input type="email" name="email" value="{{user.email}}" />
        </div>

        <div class="form-group">
          <label>Biyografi</label>
          <textarea name="bio" maxlength="200">{{user.bio}}</textarea>
          <span class="info">200 karakter sÄ±nÄ±rÄ±</span>
        </div>

        <div class="btn-group">
          <button class="btn save">Kaydet</button>
          <button class="btn cancel" type="reset">Ä°ptal</button>
        </div>
      </form>
    </div>


    <!-- ========== SOSYAL ========== -->
    <div class="content-box" id="social">
      <h2 class="title">Sosyal Medya</h2>

      <form action="/hesap/social" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />

        <div class="form-group">
          <label>Instagram</label>
          <input name="instagram" value="{{user.social.instagram}}" placeholder="@kullaniciadi" />
        </div>

        <div class="form-group">
          <label>X (Twitter)</label>
          <input name="x" value="{{user.social.x}}" placeholder="@kullaniciadi" />
        </div>

        <div class="form-group">
          <label>GitHub</label>
          <input name="github" value="{{user.social.github}}" placeholder="kullaniciadi" />
        </div>

        <div class="btn-group">
          <button class="btn save">Kaydet</button>
          <button class="btn cancel" type="reset">Ä°ptal</button>
        </div>
      </form>
    </div>


    <!-- ========== MEDYA ========== -->
    <div class="content-box" id="media">
      <h2 class="title">Profil MedyasÄ±</h2>
      <span class="img-hint">
        Maks. 5MB (JPEG/PNG) â€¢ Ã–nerilen: Avatar 400x400, Kapak 800x400
      </span>

      <div class="profile-section">
        <h3>Profil FotoÄŸrafÄ±</h3>

        <div class="avatar-box">
          <img
            id="avatarPreview"
            src="{{#if user.avatar.url}}{{user.avatar.url}}{{else}}/img/default-avatar.png{{/if}}"
            class="avatar-img"
            onerror="this.src='/img/default-avatar.png'"
          />
        </div>

        <label class="upload-btn" for="avatarUpload">Yeni Avatar YÃ¼kle</label>
        <input
          type="file"
          id="avatarUpload"
          class="hidden-input"
          accept="image/*"
        />
      </div>

      <div class="cover-section">
        <h3>Kapak FotoÄŸrafÄ±</h3>

        <div class="cover-box">
          <img
            id="coverPreview"
            src="{{#if user.coverImage.url}}{{user.coverImage.url}}{{else}}/img/default-cover.png{{/if}}"
            class="cover-img"
            onerror="this.src='/img/default-cover.png'"
          />
        </div>

        <label class="upload-btn" for="coverUpload">Yeni Kapak YÃ¼kle</label>
        <input
          type="file"
          id="coverUpload"
          class="hidden-input"
          accept="image/*"
        />
      </div>
    </div>


    <!-- ========== VERÄ° KULLANIMI ========== -->
    <div class="content-box" id="data-usage">
      <h2 class="title">Veri KullanÄ±mÄ± & Ã‡erez Ä°zinleri</h2>

      <p class="desc">Hangi verilerin kullanÄ±mÄ±na izin verdiÄŸinizi buradan yÃ¶netebilirsiniz.</p>

      <form action="/hesap/data-usage" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />

        <!-- 1) Analitik Ã‡erezler -->
        <div class="toggle-row">
          <label>Analitik Ã‡erezler</label>
          <label class="switch">
            <input type="checkbox" name="analyticsCookies"
              {{#if user.analyticsCookies}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <!-- 2) KiÅŸiselleÅŸtirme Ã‡erezleri -->
        <div class="toggle-row">
          <label>KiÅŸiselleÅŸtirme Ã‡erezleri</label>
          <label class="switch">
            <input type="checkbox" name="personalizationCookies"
              {{#if user.personalizationCookies}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <!-- 3) Hizmet Kalitesi iÃ§in Anonim Veri -->
        <div class="toggle-row">
          <label>Hizmet Kalitesi iÃ§in Anonim Veri</label>
          <label class="switch">
            <input type="checkbox" name="serviceDataUsage"
              {{#if user.serviceDataUsage}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <!-- 4) KiÅŸiselleÅŸtirilmiÅŸ Ä°Ã§erik -->
        <div class="toggle-row">
          <label>KiÅŸiselleÅŸtirilmiÅŸ Ä°Ã§erik</label>
          <label class="switch">
            <input type="checkbox" name="personalizedContent"
              {{#if user.personalizedContent}}checked{{/if}} />
            <span class="slider"></span>
          </label>
        </div>

        <div class="btn-group">
          <button class="btn save">Kaydet</button>
          <button class="btn cancel" type="reset">Ä°ptal</button>
        </div>
      </form>
    </div>


    <!-- ========== POLÄ°TÄ°KALAR ========== -->
    <div class="content-box" id="policies">
      <h2 class="title">Site PolitikalarÄ±</h2>
      <p class="desc">Gizlilik, aÃ§Ä±k rÄ±za ve kullanÄ±m ÅŸartlarÄ± belgelerine buradan eriÅŸebilirsin.</p>

      <div class="policy-card">
        <h3 class="policy-title">ğŸ“˜ AÃ§Ä±k RÄ±za Metni</h3>
        <a href="/legal/acik-riza-metni" class="policy-link">GÃ¶rÃ¼ntÃ¼le â†’</a>
      </div>

      <div class="policy-card">
        <h3 class="policy-title">ğŸ”’ Gizlilik PolitikasÄ±</h3>
        <a href="/legal/gizlilik-politikasi" class="policy-link">GÃ¶rÃ¼ntÃ¼le â†’</a>
      </div>

      <div class="policy-card">
        <h3 class="policy-title">ğŸ“„ KullanÄ±m ÅartlarÄ±</h3>
        <a href="/legal/kullanim-sartlari" class="policy-link">GÃ¶rÃ¼ntÃ¼le â†’</a>
      </div>
    </div>


    <!-- ========== ÅÄ°FRE ========== -->
    <div class="content-box" id="password">
      <h2 class="title">Åifre DeÄŸiÅŸtir</h2>
      <p class="desc">Mail adresinize doÄŸrulama kodu gÃ¶nderilecektir.</p>

      <form action="/hesap/sifre-kod" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />
        <button class="btn save">Mailime Kod GÃ¶nder</button>
      </form>

      <div id="verifyBox" style="display:none;" data-show="{{showVerify}}">
        <br>
        <hr>
        <br>
        <form action="/hesap/sifre-dogrula" method="POST">
          <input type="hidden" name="_csrf" value="{{csrfToken}}" />

          <div class="form-group">
            <label>Mail ile gelen kod</label>
            <input name="code" maxlength="6" required placeholder="123456" />
          </div>

          <button class="btn save">Kodu DoÄŸrula</button>
        </form>
      </div>
    </div>


    <!-- ========== HESAP SÄ°L ========== -->
    <div class="content-box" id="delete">
      <h2 class="title danger">HesabÄ± Sil</h2>
      <p class="desc">Bu iÅŸlem geri alÄ±namaz. TÃ¼m verileriniz silinecektir.</p>

      <button type="button" class="danger-btn">
        HesabÄ±mÄ± KalÄ±cÄ± Olarak Sil
      </button>
    </div>

  </main>
</section>


<!-- ========== DELETE MODAL ========== -->
<div id="deleteModal" class="delete-modal">
  <div class="delete-modal-content">
    <h2>HesabÄ± Sil</h2>

    <form id="deleteForm" action="/hesap/sil" method="POST">
      <input type="hidden" name="_csrf" value="{{csrfToken}}" />

      <label class="modal-label">Onay iÃ§in "sil" yazÄ±nÄ±z.</label>
      <input id="confirmC" class="modal-input" maxlength="3" autocomplete="off" />

      <label class="modal-label">Åifre</label>
      <input
        type="password"
        id="deletePassword"
        name="password"
        class="modal-input"
        required
      />

      <p id="modalError" style="color: red; margin-top: 10px; font-size: 0.9rem;"></p>

      <div class="modal-buttons">
        <button type="button" class="cancel-btn">VazgeÃ§</button>
        <button type="button" class="delete-btn">HesabÄ± Sil</button>
      </div>
    </form>
  </div>
</div>


<script type="module" src="/js/hesap.js"></script>
