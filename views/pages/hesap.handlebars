<link rel="stylesheet" href="/css/hesap.css?v=3" />

<section class="account-wrapper">

  <!-- ========== SOL SIDEBAR ========== -->
  <aside class="account-sidebar">

    <a href="/u/@{{username}}" class="public-profile-btn">
      Profilimi Görüntüle →
    </a>

    <div class="sidebar-category">Hesap</div>
    <button class="sidebar-item active" data-target="profile">Profil Bilgileri</button>

    <div class="sidebar-category">Profil Medyası</div>
    <button class="sidebar-item" data-target="media">Profil Fotoğrafları</button>

    <div class="sidebar-category">Sosyal</div>
    <button class="sidebar-item" data-target="social">Sosyal Medya</button>

    <div class="sidebar-category">Gizlilik & Güvenlik</div>
    <button class="sidebar-item" data-target="password">Şifre Değiştir</button>

    <div class="sidebar-category">Diğer</div>
    <button class="sidebar-item danger" data-target="delete">Hesabı Sil</button>

  </aside>

  <!-- ========== SAĞ PANEL ========== -->
  <main class="account-content">

    <!-- LOADER -->
    <div id="accountLoading" class="account-loading">
      <div class="spinner"></div>
      <p>Hesap bilgileri yükleniyor...</p>
    </div>

    <!-- ========== PROFİL ========== -->
    <div class="content-box" id="profile" style="display:block;">
      <h2 class="title">Profil Bilgileri</h2>
      <p class="desc">Bilgilerinizi buradan güncelleyebilirsiniz.</p>

      <form action="/hesap/profil" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />

        <div class="form-group">
          <label>Kullanıcı Adı</label>
          <input value="{{user.username}}" disabled />
          <span class="info">Bu alan değiştirilemez.</span>
        </div>

        <div class="form-group">
          <label>Ad</label>
          <input name="name" value="{{user.name}}" />
        </div>

        <div class="form-group">
          <label>Soyad</label>
          <input name="surname" value="{{user.surname}}" />
        </div>

        <div class="form-group">
          <label>E-posta</label>
          <input type="email" name="email" value="{{user.email}}" />
        </div>

        <div class="form-group">
          <label>Biyografi</label>
          <textarea name="bio" maxlength="200">{{user.bio}}</textarea>
          <span class="info">200 karakter sınırı</span>
        </div>

        <div class="btn-group">
          <button class="btn save">Kaydet</button>
          <button class="btn cancel" type="reset">İptal</button>
        </div>
      </form>
    </div>

    <!-- ========== SOSYAL ========== -->
    <div class="content-box" id="social">
      <h2 class="title">Sosyal Medya</h2>

      <form action="/hesap/social" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />

        <div class="form-group">
          <label>Instagram</label>
          <input name="instagram" value="{{user.social.instagram}}" />
        </div>

        <div class="form-group">
          <label>X (Twitter)</label>
          <input name="x" value="{{user.social.x}}" />
        </div>

        <div class="form-group">
          <label>GitHub</label>
          <input name="github" value="{{user.social.github}}" />
        </div>

        <div class="btn-group">
          <button class="btn save">Kaydet</button>
          <button class="btn cancel" type="reset">İptal</button>
        </div>
      </form>
    </div>

    <!-- ========== MEDYA ========== -->
    <div class="content-box" id="media">
      <h2 class="title">Profil Medyası</h2>
      <span class="img-hint">Maksimum 2MB (JPEG / PNG)</span>

      <div class="profile-section">
        <h3>Profil Fotoğrafı</h3>

        <div class="avatar-box">
          <img id="avatarPreview" src="{{user.avatar.url}}" class="avatar-img" />
        </div>

        <label class="upload-btn" for="avatarUpload">Yeni Avatar Yükle</label>
        <input type="file" id="avatarUpload" class="hidden-input" accept="image/*" />
      </div>

      <div class="cover-section">
        <h3>Kapak Fotoğrafı</h3>

        <div class="cover-box">
          <img id="coverPreview" src="{{user.coverImage.url}}" class="cover-img" />
        </div>

        <label class="upload-btn" for="coverUpload">Yeni Kapak Yükle</label>
        <input type="file" id="coverUpload" class="hidden-input" accept="image/*" />
      </div>
    </div>

    <!-- ========== ŞİFRE ========== -->
    <div class="content-box" id="password">
      <h2 class="title">Şifre Değiştir</h2>
      <p class="desc">Mail adresinize doğrulama kodu gönderilecektir.</p>

      <form action="/hesap/sifre-kod" method="POST">
        <input type="hidden" name="_csrf" value="{{csrfToken}}" />
        <button class="btn save">Mailime Kod Gönder</button>
      </form>

      <div id="verifyBox" style="display:none;"></div>
      <div id="newPasswordBox" style="display:none;"></div>
    </div>

    <!-- ========== HESAP SİL ========== -->
    <div class="content-box" id="delete">
      <h2 class="title danger">Hesabı Sil</h2>
      <p class="desc">Bu işlem geri alınamaz.</p>

      <button class="danger-btn" onclick="openDeleteModal()">
        Hesabımı Kalıcı Olarak Sil
      </button>
    </div>

  </main>

  <!-- ========== GLOBAL LOADER ========== -->
  <div id="globalLoader" class="global-loader" style="display:none;">
    <div class="loader-box">
      <div class="loader-spinner"></div>
      <span>Yükleniyor...</span>
    </div>
  </div>

</section>

<!-- ========== DELETE MODAL ========== -->
<div id="deleteModal" class="delete-modal">
  <div class="delete-modal-content">
    <h2>Hesabı Sil</h2>

    <form id="deleteForm" action="/hesap/sil" method="POST">
      <input type="hidden" name="_csrf" value="{{csrfToken}}" />

      <label class="modal-label">Onay için C girin</label>
      <input id="confirmC" class="modal-input" maxlength="1" />

      <label class="modal-label">Şifre</label>
      <input type="password" id="deletePassword" name="password" class="modal-input" />

      <p id="modalError"></p>

      <div class="modal-buttons">
        <button type="button" class="cancel-btn" onclick="closeDeleteModal()">Vazgeç</button>
        <button type="button" class="delete-btn" onclick="confirmDelete()">Hesabı Sil</button>
      </div>
    </form>
  </div>
</div>

<script type="module" src="/js/hesap.js"></script>
