<section class="blog-edit">
  <h1 class="edit-title">Blog Düzenle</h1>

  <form
    id="blogEditForm"
    method="POST"
    action="/blog/duzenle/{{post._id}}"
  >
    <input type="hidden" name="_csrf" value="{{csrfToken}}" />

    <!-- ✅ Silinecek eski görseller -->
    <input
      type="hidden"
      id="deleteImages"
      name="deleteImages"
      value="[]"
    />

    <!-- ✅ Yeni eklenecek görseller -->
    <input
      type="hidden"
      id="newImagesJson"
      name="newImagesJson"
      value="[]"
    />

    <!-- BAŞLIK -->
    <div class="form-group">
      <label>Başlık</label>
      <input
        type="text"
        name="title"
        value="{{post.title}}"
        required
      />
    </div>

    <!-- İÇERİK -->
    <div class="form-group">
      <label>İçerik</label>
      <textarea
        name="content"
        rows="10"
        required
      >{{post.content}}</textarea>
    </div>

    <!-- MEVCUT GÖRSELLER -->
    <div class="edit-gallery">
      <p class="gallery-title">Mevcut Görseller</p>

      {{#if post.images.length}}
        <div class="gallery-grid">
          {{#each post.images}}
            <div class="gallery-item">
              <img src="{{this.url}}" alt="Görsel" />

              <label class="remove-label">
                <input
                  type="checkbox"
                  class="deleteImageCheck"
                  data-fileid="{{this.fileId}}"
                />
                Sil
              </label>
            </div>
          {{/each}}
        </div>
      {{else}}
        <p class="no-images">
          Bu blogda görsel yok.
        </p>
      {{/if}}
    </div>

    <!-- YENİ GÖRSEL EKLE -->
    <div class="form-group">
      <label>Yeni Görsel Ekle</label>

      <span class="img-hint">
        Önerilen boyut: 1600×900 • Maks. 5 görsel • Her biri en fazla 5 MB
        <br />
        <strong>Tüm görselleri tek seferde seçiniz.</strong>
      </span>

      <button
        type="button"
        class="upload-label"
        id="openEditImagePicker"
      >
        Görsel Yükle
      </button>

      <input
        type="file"
        id="newImages"
        accept="image/*"
        multiple
        hidden
      />

      <div
        id="editPreviewBox"
        class="preview-container"
      ></div>
    </div>

    <button class="btn save">Kaydet</button>
  </form>

  <!-- ✅ Upload Loader -->
  <div
    id="blogEditLoading"
    class="blog-upload-loader"
    style="display:none;"
  >
    <div class="blog-loader-box">
      <div class="blog-spinner"></div>
      <span>Görseller yükleniyor...</span>
    </div>
  </div>
</section>

<script type="module" src="/js/blogEditUpload.js"></script>
