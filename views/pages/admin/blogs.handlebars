<div class="admin-search-bar">
  <h1>Blog YÃ¶netimi</h1>

  <form action="/admin/bloglar" method="GET" class="admin-filter-bar">

    <!-- ðŸ” Genel arama -->
    <input
      type="text"
      name="q"
      placeholder="BaÅŸlÄ±k, iÃ§erik veya yazar ara..."
      class="search-input"
      value="{{query.q}}"
    />

    <!-- ðŸ‘¤ Yazar filtresi -->
    <input
      type="text"
      name="author"
      placeholder="Yazar kullanÄ±cÄ± adÄ±"
      class="search-input"
      value="{{query.author}}"
      style="max-width:200px;"
    />

    <!-- ðŸ“… Tarih filtresi -->
    <select name="period">
      <option value="">TÃ¼m Zamanlar</option>
      <option value="7"  {{#if (eq query.period "7")}}selected{{/if}}>Son 7 gÃ¼n</option>
      <option value="30" {{#if (eq query.period "30")}}selected{{/if}}>Son 30 gÃ¼n</option>
      <option value="90" {{#if (eq query.period "90")}}selected{{/if}}>Son 90 gÃ¼n</option>
    </select>

    <!-- ðŸ”ƒ SÄ±ralama -->
    <select name="sort">
      <option value="new" {{#if (eq query.sort "new")}}selected{{/if}}>En Yeni</option>
      <option value="old" {{#if (eq query.sort "old")}}selected{{/if}}>En Eski</option>
      <option value="title" {{#if (eq query.sort "title")}}selected{{/if}}>BaÅŸlÄ±ÄŸa GÃ¶re</option>
    </select>

    <button type="submit" class="admin-btn">
      Filtrele
    </button>

    {{#if query.q}}
      <a href="/admin/bloglar" class="admin-btn ghost">
        Temizle
      </a>
    {{/if}}

  </form>
</div>

<div class="table-container">
  <p style="margin-top:10px; margin-bottom:20px; font-size:14px; color:#555;">
  {{blogs.length}} kayÄ±t bulundu
</p>

  <table class="admin-table">
    <thead>
      <tr>
        <th width="60">Kapak</th>
        <th>BaÅŸlÄ±k</th>
        <th>Yazar</th>
        <th>Tarih</th>
        <th>Ä°ÅŸlemler</th>
      </tr>
    </thead>
    <tbody>
      {{#each blogs}}
      <tr>
        <td>
          {{#if this.images.0.url}}
            <img src="{{this.images.0.url}}" class="table-img" style="border-radius:4px;">
          {{else}}
            <div style="width:40px; height:40px; background:#eee; border-radius:4px;"></div>
          {{/if}}
        </td>
        <td style="max-width:250px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">
          {{this.title}}
        </td>
        <td>{{this.username}}</td>
        <!-- Yeni Helper -->
        <td>{{generateDateTime this.date}}</td>
        <td>
          <!-- BloÄŸa Git Butonu -->
          <a href="/blog/{{this._id}}" target="_blank" class="action-btn btn-view" title="BloÄŸu GÃ¶rÃ¼ntÃ¼le">
            <i class="fa-solid fa-eye"></i> Git
          </a>
          
          <a href="/admin/blog/{{this._id}}/duzenle" class="action-btn btn-edit" title="DÃ¼zenle">
            <i class="fa-solid fa-pen"></i>
          </a>
          
          <form action="/admin/blog/{{this._id}}/sil" method="POST" style="display:inline;" onsubmit="return confirm('Bu blogu silmek istediÄŸine emin misin?');">
            <input type="hidden" name="_csrf" value="{{../csrfToken}}">
            <button class="action-btn btn-delete" title="Sil">
              <i class="fa-solid fa-trash"></i>
            </button>
          </form>
        </td>
      </tr>
      {{/each}}
    </tbody>
  </table>
</div>